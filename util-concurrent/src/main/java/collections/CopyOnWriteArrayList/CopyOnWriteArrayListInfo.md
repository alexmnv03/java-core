# CopyOnWriteArrayList 

это потокобезопасный вариант of ArrayList. Подобно ArrayList, CopyOnWriteArray, он управляет 
массивом для хранения его элементов. Разница в том, что все мутативные операции, такие
как add, set, remove, clear,... создают новую копию массива, которым он управляет.

Класс CopyOnWriteArrayList содержит изменяемую ссылку на неизменяемый массив,
обеспечивая преимущества потокобезопасности без необходимости использования блокировок.
Т.е. при выполнении модифицирующей операции CopyOnWriteArrayList создаёт новую копию списка
и гарантирует, что её итераторы вернут состояние списка на момент создания итератора и не
вызовут ConcurrentModificationException. Описание CopyOnWriteArrayList с примером представлено здесь.

Стоимость использования CopyOnWriteArrayList очень высока, вам придется платить больше за 
ресурс и производительность. Однако CopyOnWriteArrayList пригодится, когда вы не можете или 
не хотите синхронизировать при обходе (traversal) элементов списка.
Для лучшего понимания рассмотрим ситуацию, когда два Thread используют один и тот же объект List. 
В то время как Thread-A обходит элементы List, он замораживает действия вставки или обновления Thread-B 
в List для целостности данных.

При использовании обычной ArrayList в многопоточном приложении необходимо либо блокировать целый 
список во время перебора, либо клонировать его перед перебором; оба варианта требуют дополнительных 
ресурсов. CopyOnWriteArrayList вместо этого создаёт новую копию списка при выполнении 
модифицирующей операции и гарантирует, что её итераторы вернут состояние списка на момент создания 
итератора и не выкинут ConcurrentModificationException. Это так называемый алгоритм CopyOnWrite. 
Нет необходимости клонировать список до перебора или блокировать его во время перебора, т.к. 
используемая итератором копия списка изменяться не будет. Другими словами, CopyOnWriteArrayList 
содержит изменяемую ссылку на неизменяемый массив, поэтому до тех пор, пока эта ссылка остаётся 
фиксированной, вы получаете все преимущества потокобезопасности от неизменности без 
необходимости блокировок.

Когда вы создаете объект Iterator из CopyOnWriteArrayList, он помогает вам пройти через элементы 
текущего массива (когда был создан Iterator). Элементы этого массива не изменяются за время 
существования Iterator. Это возможно потому, что любые действия add, set, remove, clear, .. на 
CopyOnWriteArrayList создают другой массив, который является копией текущего массива, см. пример 
CopyOnWriteArrayListExample.java

Кроме специальных характеристик, упомянутых выше, CopyOnWriteArrayList также является обычным List
